CREATE TABLE TEAM
(
	TEAM_ID NUMBER PRIMARY KEY,
	TEAM_ABBRV VARCHAR2(5) NOT NULL,
	TEAM_NAME VARCHAR2(20) NOT NULL,
	KIT VARCHAR2(500),
	KITGK VARCHAR2(500)	
);

CREATE TABLE PLAYER_POSITION
(
	POSITION NUMBER,
	POSITION_NAME VARCHAR2(50) NOT NULL,
	POSITION_SHORT_NAME VARCHAR2(20) NOT NULL,
	CONSTRAINTS PKPOSITION PRIMARY KEY(POSITION)
);

CREATE TABLE PLAYER
(
	PLAYER_ID NUMBER PRIMARY KEY,
	FIRST_NAME VARCHAR2(50) NOT NULL,
	LAST_NAME VARCHAR2(50) NOT NULL,
	POSITION NUMBER NOT NULL,
	SQUAD_NUMBER NUMBER,
	POINTS NUMBER,
	COST NUMBER,
	TEAM_ID NUMBER NOT NULL,
	CONSTRAINT FKPOSITION FOREIGN KEY(POSITION) REFERENCES PLAYER_POSITION(POSITION),
	CONSTRAINT FKTEAM_ID FOREIGN KEY(TEAM_ID) REFERENCES TEAM(TEAM_ID)
);

CREATE TABLE USERS
(
	USER_ID NUMBER PRIMARY KEY,
	USERNAME VARCHAR2(50) NOT NULL,
	FIRST_NAME VARCHAR2(50) NOT NULL,
	LAST_NAME VARCHAR2(50) NOT NULL,
	EMAIL VARCHAR2(50) NOT NULL,
	PASSWORD VARCHAR2(250) NOT NULL,
	USER_TEAM_ID NUMBER,
	CONSTRAINTS UNIQUSERNAME UNIQUE(USERNAME),
	CONSTRAINTS UNIQEMAIL UNIQUE(EMAIL),
	CONSTRAINTS UNIQUSER_TEAM_ID UNIQUE(USER_TEAM_ID)
);

CREATE TABLE CHIP
(
	CHIP_ID NUMBER PRIMARY KEY,
	CHIP_NAME VARCHAR2(50) NOT NULL
);

CREATE TABLE USER_TEAM
(
	USER_TEAM_ID NUMBER NOT NULL,
	USER_TEAM_NAME VARCHAR2(50) NOT NULL,
	GAMEWEEK NUMBER NOT NULL,
	POINTS NUMBER,
	REMAINING_MONEY NUMBER,
	TRANSFERS NUMBER,
	CHIPS NUMBER,
	VALUE NUMBER,
	CAPTAIN NUMBER,
	CONSTRAINTS PKUSER_TEAM PRIMARY KEY(USER_TEAM_ID, GAMEWEEK),
	CONSTRAINTS FKCAPTAIN FOREIGN KEY(CAPTAIN) REFERENCES PLAYER(PLAYER_ID),
	CONSTRAINTS FKCHIP FOREIGN KEY(CHIPS) REFERENCES CHIP(CHIP_ID),
	CONSTRAINTS FKUSERTEAM_ID FOREIGN KEY(USER_TEAM_ID) REFERENCES USERS(USER_TEAM_ID)

);

CREATE TABLE LEAGUE
(
	LEAGUE_CODE VARCHAR2(50) PRIMARY KEY,
	LEAGUE_NAME VARCHAR2(50) NOT NULL,
	TYPE NUMBER NOT NULL,
	START_GW NUMBER NOT NULL,
	ADMINISTRATOR NUMBER NOT NULL,
	AVERAGE_POINTS NUMBER,
	CONSTRAINTS FKADMINISTRATOR FOREIGN KEY(ADMINISTRATOR) REFERENCES USERS(USER_ID)
);


CREATE TABLE LEAGUE_TEAMS
(
	LEAGUE_CODE VARCHAR2(50) NOT NULL,
	USER_TEAM_ID NUMBER NOT NULL,
	JOINED_GW NUMBER NOT NULL,
	CONSTRAINTS PKLEAGUE_TEAM PRIMARY KEY(LEAGUE_CODE, USER_TEAM_ID),
	CONSTRAINTS FKLEAGUE_CODE FOREIGN KEY(LEAGUE_CODE) REFERENCES LEAGUE(LEAGUE_CODE),
	CONSTRAINTS FKUSERID FOREIGN KEY(USER_TEAM_ID) REFERENCES USERS(USER_TEAM_ID)
);

CREATE TABLE H2H_LEAGUE
(
	LEAGUE_CODE VARCHAR2(50) PRIMARY KEY,
	LEAGUE_NAME VARCHAR2(50) NOT NULL,
	START_GW NUMBER NOT NULL,
	MAXIMUM_TEAMS NUMBER,
	ADMINISTRATOR NUMBER NOT NULL,
	CONSTRAINTS FK_H2H_ADMINISTRATOR FOREIGN KEY(ADMINISTRATOR) REFERENCES USERS(USER_ID)
);

CREATE TABLE H2H_LEAGUE_TEAMS
(
	LEAGUE_CODE VARCHAR2(50) NOT NULL,
	USER_TEAM_ID NUMBER NOT NULL,
	POINTS NUMBER,
	WIN NUMBER,
	LOSE NUMBER,
	DRAW NUMBER,
	CONSTRAINTS PKH2H_LEAGUE_TEAM PRIMARY KEY(LEAGUE_CODE, USER_TEAM_ID),
	CONSTRAINTS FKH2H_LEAGUE_CODE FOREIGN KEY(LEAGUE_CODE) REFERENCES H2H_LEAGUE(LEAGUE_CODE),
	CONSTRAINTS FKH2H_USERID FOREIGN KEY(USER_TEAM_ID) REFERENCES USERS(USER_TEAM_ID)
);

CREATE TABLE H2H_FIXTURE
(
	LEAGUE_CODE VARCHAR2(50) NOT NULL,
	TEAM_A NUMBER NOT NULL,
	TEAM_B NUMBER NOT NULL,
	GAMEWEEK NUMBER NOT NULL,
	CONSTRAINTS FKH2H_FIXTURE_LEAGUE_CODE FOREIGN KEY(LEAGUE_CODE) REFERENCES H2H_LEAGUE(LEAGUE_CODE),
	CONSTRAINTS FKH2H_TEAM_A FOREIGN KEY(TEAM_A) REFERENCES USERS(USER_TEAM_ID),
	CONSTRAINTS FKH2H_TEAM_B FOREIGN KEY(TEAM_B) REFERENCES USERS(USER_TEAM_ID)
);

CREATE TABLE FIXTURE
(
	MATCH_ID NUMBER PRIMARY KEY,
	HOME_TEAM NUMBER NOT NULL,
	AWAY_TEAM NUMBER NOT NULL,
	HOME_TEAM_SCORE NUMBER,
	AWAY_TEAM_SCORE NUMBER,
	KICK_OFF_TIME DATE,
	GAMEWEEK NUMBER NOT NULL,
	CONSTRAINTS FKHT FOREIGN KEY(HOME_TEAM) REFERENCES TEAM(TEAM_ID),
	CONSTRAINTS FKAT FOREIGN KEY(AWAY_TEAM) REFERENCES TEAM(TEAM_ID)
);


CREATE TABLE FIELD_PLAYER
(
	USER_TEAM_ID NUMBER NOT NULL,
	PLAYER_ID NUMBER NOT NULL,
	GAMEWEEK NUMBER NOT NULL,
	CONSTRAINTS FKUID FOREIGN KEY(USER_TEAM_ID) REFERENCES USERS(USER_TEAM_ID),
	CONSTRAINTS FKPID FOREIGN KEY(PLAYER_ID) REFERENCES PLAYER(PLAYER_ID)
);

CREATE TABLE BENCH_PLAYER
(
	USER_TEAM_ID NUMBER NOT NULL,
	PLAYER_ID NUMBER NOT NULL,
	GAMEWEEK NUMBER NOT NULL,
	PRIORITY NUMBER NOT NULL,
	CONSTRAINTS FKBUID FOREIGN KEY(USER_TEAM_ID) REFERENCES USERS(USER_TEAM_ID),
	CONSTRAINTS FKBPID FOREIGN KEY(PLAYER_ID) REFERENCES PLAYER(PLAYER_ID)
);


CREATE TABLE PLAYER_STAT
(
	PLAYER_ID NUMBER NOT NULL,
	MATCH_ID NUMBER NOT NULL,
	GAMEWEEK NUMBER, 
	MIN_PLAYED NUMBER,
	GOAL_SCORED NUMBER,
	ASSIST NUMBER,
	CLEAN_SHEET NUMBER,
	GOALS_CONCEDED NUMBER,
	OWN_GOALS NUMBER,
	PENALTIES_SAVED NUMBER,
	PENALTIES_MISSED NUMBER,
	YELLOW_CARDS NUMBER,
	RED_CARDS NUMBER,
	SAVES NUMBER, 
	BONUS NUMBER,
	PLAYER_VALUE NUMBER,
	POINTS NUMBER,
	SELECTED_BY NUMBER,
	TRANSFERSIN NUMBER,
	TRANSFERSOUT NUMBER,
	CONSTRAINTS PKPLAYER_STAT PRIMARY KEY(MATCH_ID, PLAYER_ID),
	CONSTRAINTS FKPSMID FOREIGN KEY(MATCH_ID) REFERENCES FIXTURE(MATCH_ID),
	CONSTRAINTS FKPSPID FOREIGN KEY(PLAYER_ID) REFERENCES PLAYER(PLAYER_ID)
);



